<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="View of Algorithms">
<meta name="keywords" content="Algorithms, Sorting, Selection">
<meta name="author" content="Adrian T. Visarra">
<title>Selection Sort</title>
<script>


//==============================================
var ELEMENTSIZE = 50;
var DELAY = 50;
//==============================================


var debug_board;
var canvas_board;
var array_items = [];
function debug(text){
	var li = document.createElement("li");
	var textnode = document.createTextNode(text);
	li.appendChild(textnode);
	debug_board.insertBefore(li, debug_board.firstChild);
}
function getMaxItem(i, len){
	if(len<=0){
		return 0;
	}else if(len==1){
		return array_items[i];
	}else if(len==2){
		if(array_items[i]>array_items[i+1]){
			return array_items[i];
		}else{
			return array_items[i+1];
		}
	}else{
		var fhalf = Math.ceil(len/2);
		var shalf = len - fhalf;
		var fmax = getMaxItem(i, fhalf);
		var smax = getMaxItem(i+fhalf, shalf);
		if(fmax > smax){
			return fmax;
		}else{
			return smax;
		}
	}	
}
function draw(){
	var ctx = canvas_board.getContext("2d");
	ctx.clearRect(0, 0, canvas_board.width, canvas_board.height);
	var max_item = getMaxItem(0, array_items.length);
	var box_width = canvas_board.width;
	var box_height = canvas_board.height;
	var element_width = 0;
	var element_height = 0;	
	var i = 0;
	for(i=0;i<array_items.length;i++){
		element_width = box_width / array_items.length;
		element_height = Math.floor((array_items[i]/max_item) * box_height);
		ctx.beginPath();
		var width_offset = Math.floor(element_width/2);
		var height_offset = box_height - element_height;
		ctx.moveTo(i*element_width+width_offset, height_offset);
		if((counter1<array_items.length) && (i==counter1 || i==counter2)){
			ctx.strokeStyle = '#CCCCCC';
		}else{
			ctx.strokeStyle = '#000000';
		}
		ctx.lineWidth = element_width - 1;
		ctx.lineTo(i*element_width+width_offset, element_height + height_offset);
		ctx.stroke();
	}
}
var counter1;
var counter2;
var loop1Limit;
var loop1Delay;
var loop2Limit;
var loop2Delay;
function looper1(){
	setTimeout(function(){
		if(counter1<loop1Limit){
			looper2();
		}else{
			draw();
			onDone();
		}
	}, loop1Delay);
}
function looper2(){
	setTimeout(function(){
		if(counter2<loop2Limit){
			draw();
			var i = counter1;
			var j = counter2;
			if(array_items[j] < array_items[i]){
				var tmp = array_items[j];
				array_items[j] = array_items[i];
				array_items[i] = tmp;				
			}
			counter2++;
			looper2();			
		}else{
			counter1++;
			counter2=counter1+1;
			looper1();
		}
	}, loop2Delay);
}
function selectionSort(){
	draw();
	counter1=0;
	counter2=counter1+1;
	loop1Limit=array_items.length;
	loop1Delay=0;
	loop2Limit=array_items.length;
	loop2Delay=DELAY;
	looper1();
	/*algorithm for selection sort
	for(var i=0;i<array_items.length;i++){
		for(var j=i+1;j<array_items.length;j++){
			if(array_items[j] < array_items[i]){
				var tmp = array_items[j];
				array_items[j] = array_items[i];
				array_items[i] = tmp;
			}
		}
	}*/
}
function generateInput(size){
	var tmparray = [];
	for(var i=1;i<=size;i++){
		tmparray.push(i);
	}
	var randomindex=Math.floor((Math.random() * size) + 1);
	for(var i=0;i<size;i++){
		while(tmparray[randomindex] == -1){
			randomindex = Math.floor((Math.random() * size));
		}
		array_items.push(tmparray[randomindex]);
		tmparray[randomindex] = -1;
	}
}
function resizeEvent(){
	var remainder = window.innerWidth%(array_items.length+1);
	var factor = Math.floor(window.innerWidth/(array_items.length+1));
	canvas_board.setAttribute('width', window.innerWidth-remainder-factor);//give right margin and remove remainder
	canvas_board.setAttribute('height', window.innerHeight-100);
	draw();
}
function onDone(){
	debug("--DONE--");
}
function run(){
	debug_board = document.getElementById("debugger");
	canvas_board = document.getElementById("board");	
	generateInput(ELEMENTSIZE);
	resizeEvent();
	window.onresize=resizeEvent;//only attach this even after we get the number of elements
	selectionSort();
}
window.onload = run;
</script>
<style>
#board{
	border: 1px solid #CCCCCC;
}
</style>
</head>
<body>
<p>Selection Sort Algorithm</p>
<canvas id="board"></canvas>
<div id="debugger"></div>
</body>
</html>